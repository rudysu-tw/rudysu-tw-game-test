<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>ÂçáÁ¥öÁâà IQÊ∏¨È©ó</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', 'Microsoft JhengHei', Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .container {
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 14px 40px rgba(102, 126, 234, 0.18);
            max-width: 500px;
            width: 100%;
            padding: 32px 18px 22px 18px;
        }
        .header h1 {
            font-size: 1.9em;
            color: #667eea;
            text-align: center;
            margin-bottom: 8px;
            display: flex;
            justify-content: center;
            gap: 8px;
        }
        .iq-bar-bg {
            height: 12px;
            background: #e0e0ef;
            border-radius: 6px;
            margin: 16px 0;
            overflow: hidden;
        }
        .iq-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #fbc531 0%, #10ac84 100%);
            border-radius: 6px;
            transition: width 0.4s cubic-bezier(.87,-0.41,.19,1.71);
        }
        .question-container {
            margin: 0 0 18px 0;
            display: none;
        }
        .question-container.active {
            display: block;
            animation: fadeIn .2s;
        }
        @keyframes fadeIn {
            from{ opacity:0;transform: translateY(10px);}
            to{ opacity:1;transform: translateY(0);}
        }
        .question-number {
            color: #667eea;
            font-size: 0.94em;
            margin-bottom: 7px;
            text-align: left;
        }
        .question-text {
            font-size: 1.15em;
            font-weight: 600;
            color: #222;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .option {
            background: #f6f6fa;
            border: 2px solid #e0e0ef;
            padding: 13px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all .2s;
            position: relative;
        }
        .option.selected {
            border: 2px solid #667eea;
            background: #ecf0fa;
        }
        .option input[type=radio] {
            accent-color: #667eea;
            margin-right: 6px;
        }
        .nav-btns{
            display:flex;
            gap:15px;
            margin-top:15px;
        }
        button{
            padding: 10px 22px;
            font-size: 1em;
            border-radius: 7px;
            border: none;
            background: #667eea;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition:.2s;
            min-width: 100px;
        }
        .btn-prev{
            background: #e6e9fa;
            color:#555;
        }
        .btn-prev:hover, .btn-next:hover, .btn-restart:hover{ box-shadow:0 2px 10px #a6b0f68d;}
        .btn-next[disabled]{
            opacity:.6;
            cursor:not-allowed;
        }

        /* ÁµêÊûúÈ†Å */
        .result-container{
            display:none;
            text-align:center;
            padding:0 10px;
            animation: fadeIn .4s;
        }
        .result-container.active{
            display:block;
        }
        .result-score{
            font-size: 40px;
            color: #667eea;
            font-weight: 700;
            margin-bottom: 6px;
        }
        .result-level{
            font-size: 22px;
            color:#764ba2;
            margin-bottom:7px;
        }
        .result-emoji{
            font-size: 60px;
            margin-bottom:4px;
        }
        .result-description{
            margin: 13px 0 18px 0;
            background: #f5f5fe;
            border-left: 4px solid #667eea;
            border-radius: 6px;
            padding: 11px 8px 10px 13px;
            color: #666;
            font-size:1em;
            line-height:1.65;
        }
        .stats{
            display:flex;
            justify-content:space-around;
            gap:18px;
            margin:14px 0 18px 0;
        }
        .stat-box{
            background: #f7f7fa;
            border-radius:7px;
            padding:10px;
            min-width:96px;
        }
        .stat-label{
            color:#888;
            font-size:.9em;
        }
        .stat-value{
            font-size:21px;
            color:#667eea;
            font-weight:700;
            margin-top:2px;
        }
        .btn-restart{
            width:100%;
            background: linear-gradient(135deg,#667eea,#a987ee 100%);
            margin-top:14px;
        }
        /* ÂïüÂãïÁï´Èù¢ */
        .start-screen{
            text-align:center;
            animation: fadeIn .4s;
        }
        .start-emoji{
            font-size:80px;
            margin-bottom:18px;
            animation: bounce 1.8s infinite;
        }
        @keyframes bounce{
            0%,100%{transform:translateY(0);}
            50%{transform:translateY(-18px);}
        }
        @media (max-width:480px){
            .container{max-width:99vw;padding:12px 3vw 16px 3vw;}
            .header h1{font-size:1.1em;}
            .question-text{font-size:1em;}
        }
        /* --- ÁâπÊïà‰∫íÂãïÂçÄ --- */
        .emoji-feedback{
            position: fixed;
            z-index: 999;
            left: 50%;
            top: 30%;
            transform: translateX(-50%);
            pointer-events: none;
            font-size: 60px;
            opacity: 0;
            animation: feedbackPop .88s forwards;
        }
        @keyframes feedbackPop {
            0% {transform:scale(0.5) translateX(-50%); opacity:0;}
            30%{transform:scale(1.15) translateX(-50%); opacity:0.93;}
            60%{transform:scale(1) translateX(-50%);opacity:1;}
            100%{transform:scale(0.6) translateX(-50%); opacity:0;}
        }
    </style>
</head>
<body>
<div class="container">
    <!-- ÂïüÂãïÁï´Èù¢ -->
    <div class="start-screen" id="startScreen">
        <div class="start-emoji">üß†</div>
        <h2>IQÊ∏¨È©ó ÂçáÁ¥öÁâà</h2>
        <div style="color:#666;font-size:.98em;">ÊØèÊ¨°Ê∏¨È©óÈÉΩÊúÉÂæûÈ°åÂ∫´Èö®Ê©üÊäΩÂá∫20È°å<br>‰æÜÊåëÊà∞‰Ω†ÁöÑÈÇèËºØÊÄùÁ∂≠ÔºÅ</div>
        <button class="btn-next" style="margin-top:26px;width:100%;" onclick="startTest()">ÈñãÂßãÊ∏¨È©ó</button>
    </div>

    <!-- ‰∏ªÊ∏¨È©óÁï´Èù¢ -->
    <div id="testScreen" style="display: none;">
        <div class="header">
            <h1>üß† ÂçáÁ¥öÁâà IQÊ∏¨È©ó</h1>
        </div>
        <div class="iq-bar-bg">
            <div class="iq-bar" id="iqBar"></div>
        </div>
        <div id="questionsContainer"></div>
        <div class="nav-btns">
            <button class="btn-prev" onclick="previousQuestion()" id="btnPrev">‚Üê ‰∏ä‰∏ÄÈ°å</button>
            <button class="btn-next" onclick="nextQuestion()" id="btnNext" disabled>‰∏ã‰∏ÄÈ°å ‚Üí</button>
        </div>
    </div>

    <!-- ÁµêÊûúÁï´Èù¢ -->
    <div class="result-container" id="resultScreen">
        <div class="result-emoji" id="resultEmoji">üéâ</div>
        <div class="result-level" id="resultLevel"></div>
        <div class="result-score" id="resultScore">--</div>
        <div class="result-description" id="resultDescription"></div>
        <div class="stats">
            <div class="stat-box">
                <div class="stat-label">Ê≠£Á¢∫Á≠îÊ°à</div>
                <div class="stat-value" id="correctCount"></div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Ê≠£Á¢∫Áéá</div>
                <div class="stat-value" id="correctRate"></div>
            </div>
        </div>
        <button class="btn-restart" onclick="restartTest()">ÈáçÊñ∞Ê∏¨È©ó üîÑ</button>
    </div>
</div>
<!-- emojiÂõûÈ•ã -->
<div id="emojiFeedback" class="emoji-feedback" style="display:none"></div>
<script>
const questionBank = [
    {question:"2, 4, 6, 8, ? ‚Äî ‰∏ã‰∏ÄÂÄãÊï∏Â≠óÊòØ‰ªÄÈ∫ºÔºü",options:["9","10","12","14"],correct:2},
    {question:"Â¶ÇÊûú‰∏ÄÂÄãÊ≠£ÊñπÂΩ¢Êúâ4ÂÄãËßíÔºåÈÇ£È∫ºÂúìÂΩ¢ÊúâÂπæÂÄãËßíÔºü",options:["0","1","4","ÁÑ°Èôê"],correct:0},
    {question:"25 √∑ 5 = ?",options:["4","5","6","7"],correct:1},
    {question:"Âì™ÂÄãÂñÆÂ≠óÁöÑÂ≠óÊØçÈ†ÜÂ∫è‰∏çÂ∞çÔºü",options:["ABCD","EFGH","IJKL","MNPQ"],correct:3},
    {question:"Â¶ÇÊûú‰ªäÂ§©ÊòØÊòüÊúü‰∏âÔºå10Â§©ÂæåÊòØÊòüÊúüÂπæÔºü",options:["ÊòüÊúü‰∫å","ÊòüÊúü‰∏â","ÊòüÊúüÂõõ","ÊòüÊúü‰∫î"],correct:2},
    {question:"‰∏ÄÂÄãËõãÁ≥ïÂàá4‰ªΩÔºåÊØè‰ªΩ‰ΩîËõãÁ≥ïÁöÑÔºü",options:["1/2","1/4","1/3","1/5"],correct:1},
    {question:"CAT„ÄÅDOG„ÄÅBIRD ‚Äî ‰∏ã‰∏ÄÂÄãÊáâË©≤ÊòØÔºü",options:["ELEPHANT","FISH","MOUSE","ÁÑ°Ê≥ïÂà§Êñ∑"],correct:3},
    {question:"3 √ó 7 = ?",options:["20","21","22","23"],correct:1},
    {question:"Âì™ÂÄãË©ûËàáÂÖ∂‰ªñ‰∏âÂÄã‰∏çÂêåÈ°ûÔºü",options:["ËòãÊûú","È¶ôËïâ","Ê§ÖÂ≠ê","Ê©ôÂ≠ê"],correct:2},
    {question:"100 - 25 = ?",options:["65","70","75","80"],correct:2},
    {question:"Â¶ÇÊûúA=1, B=2, ÈÇ£È∫ºC=?",options:["2","3","4","5"],correct:1},
    {question:"‰∏ÄÂ∞èÊôÇÊúâÂ§öÂ∞ëÂàÜÈêòÔºü",options:["30","60","120","3600"],correct:1},
    {question:"Âì™ÂÄãÂΩ¢ÁãÄÊúâÊúÄÂ§öÈÇäÔºü",options:["‰∏âËßíÂΩ¢","Ê≠£ÊñπÂΩ¢","‰∫îÈÇäÂΩ¢","ÂúìÂΩ¢"],correct:2},
    {question:"8 + 12 - 5 = ?",options:["13","14","15","16"],correct:2},
    {question:"‰∏ÄÊú¨Êõ∏100È†ÅÔºåËÆÄÂÆå5/10ÈúÄË¶ÅÂ§öÂ∞ëÈ†ÅÔºü",options:["25","40","50","60"],correct:2},
    {question:"Âì™ÂÄãÊòØ„ÄåÈñãÂøÉ„ÄçÁöÑÂèçÁæ©Ë©ûÔºü",options:["Âø´Ê®Ç","Èõ£ÈÅé","ËààÂ•Æ","È©öË®ù"],correct:1},
    {question:"9 √ó 2 + 3 = ?",options:["19","20","21","22"],correct:2},
    {question:"‰∏ÄÈÄ±ÊúâÂ§öÂ∞ëÂ§©Ôºü",options:["5","6","7","8"],correct:2},
    {question:"48 √∑ 6 = ?",options:["6","7","8","9"],correct:2},
    {question:"Êò®Â§©ÊòØ12/31Ôºå‰ªäÂ§©ÊòØÔºü",options:["12/30","1/1","1/2","12/32"],correct:1},
    // ‰ª•‰∏ãÊñ∞Â¢û10È°å
    {question:"Âì™ÂÄãÂúãÂÆ∂Âú®‰∫ûÊ¥≤Ôºü",options:["Ê≥ïÂúã","‰∏≠Âúã","ÂüÉÂèä","Âä†ÊãøÂ§ß"],correct:1},
    {question:"4+4√ó2=?",options:["12","16","8","10"],correct:0},
    {question:"‰∏ãÂàóÂì™ÂÄãÊòØÊ∂≤È´îÔºü",options:["Èêµ","Ê∞¥","ÈπΩ","ÁéªÁíÉ"],correct:1},
    {question:"ËÖ≥ÊúâÂπæÊ†πËÖ≥Ë∂æÔºü",options:["3","4","5","6"],correct:2},
    {question:"Â§™ÈôΩÂæûÂì™ÈÇäÂçáËµ∑Ôºü",options:["Êù±","Âçó","Ë•ø","Âåó"],correct:0},
    {question:"1, 3, 6, 10, ? ‚Äî ‰∏ã‰∏ÄÂÄãÊï∏Â≠óÔºü",options:["14","15","16","18"],correct:1},
    {question:"2, 3, 5, 7, 11, ? ‚Äî ‰∏ã‰∏ÄÂÄãË≥™Êï∏Ôºü",options:["13","14","15","17"],correct:0},
    {question:"‰∏ÄÊâìÊúâÂπæÂÄãÔºü",options:["6","10","12","20"],correct:2},
    {question:"Á¥ÖÁ∂†ÁáàÁ¥ÖÁáà‰ª£Ë°®Ôºü",options:["ÂâçÈÄ≤","Á¶ÅÊ≠¢","ÂÅúÊ≠¢","Ë≠¶Âëä"],correct:2},
    {question:"Âì™ÂÄãÊòØÂì∫‰π≥ÂãïÁâ©Ôºü",options:["ÈùíËõô","‰ºÅÈµù","ÈØ®È≠ö","ÈØäÈ≠ö"],correct:2}
];
// --- Êú¨Âú∞Ë®òÈåÑÈ°åÁõÆÁ≠îÂ∞ç/ÈåØÊÉÖÊ≥Å ---
function getHistory(){
    const data = localStorage.getItem("IQTestHistory");
    return data ? JSON.parse(data) : {};
}
function setHistory(obj){
    localStorage.setItem("IQTestHistory",JSON.stringify(obj));
}
// --- ‰∏ªÊµÅÁ®ãËÆäÊï∏ ---
let selectedQuestions=[];
let current=0, answers=[];
function startTest(){
    // Èö®Ê©üÊäΩÂèñ20È°åÔºåÈ†ÜÂ∫èÊ¥óÁâå
    let idx = Array.from({length:questionBank.length}, (_,i)=>i);
    idx = shuffle(idx).slice(0,20);
    selectedQuestions = idx.map(i=>questionBank[i]);
    answers = Array(20).fill(-1);
    current = 0;

    document.getElementById("startScreen").style.display = "none";
    document.getElementById("testScreen").style.display = "";

    renderQuestions();
    updateIQBar();
}
function renderQuestions(){
    const qs=document.getElementById("questionsContainer");
    qs.innerHTML="";
    selectedQuestions.forEach((q,idx)=>{
        const div=document.createElement("div");
        div.className=`question-container${current===idx?' active':''}`;
        let optionsHtml = "";
        q.options.forEach((opt,oi)=>{
            optionsHtml +=
            `<div class="option${answers[idx]===oi?" selected":""}"
                onclick="selectAnswer(${idx},${oi},this)">
                <input type="radio" name="option${idx}" value="${oi}" ${answers[idx]===oi?"checked":""} readonly>
                ${opt}
            </div>`;
        });
        div.innerHTML=`
            <div class="question-number">Á¨¨ ${idx+1} / 20 È°å</div>
            <div class="question-text">‚ùì ${q.question}</div>
            <div class="options">${optionsHtml}</div>
        `;
        qs.appendChild(div);
    });
    updateNavUI();
}
function selectAnswer(idx,oi,dom){
    answers[idx]=oi;
    // Â∞çÁöÑÂç≥ÊôÇ‰∫íÂãï
    const correctAns = selectedQuestions[idx].correct;
    if(oi==correctAns){
        showEmoji("üéâ");
        animateIQBar(true);
    } else {
        showEmoji("üí°");
        animateIQBar(false);
    }
    // Êú¨Âú∞Ë®òÈåÑÊõ¥Êñ∞
    let hist = getHistory();
    const qid = selectedQuestions[idx].question;
    if(!hist[qid]) hist[qid]={correct:0,wrong:0};
    if(oi==correctAns) hist[qid].correct++;
    else hist[qid].wrong++;
    setHistory(hist);

    renderQuestions();
}
function updateNavUI(){
    document.getElementById("btnPrev").style.display = current>0 ? "" : "none";
    document.getElementById("btnNext").disabled = answers[current]===-1;
    document.getElementById("btnNext").innerText = current===19?"ÂÆåÊàêÊ∏¨È©ó ‚úì":"‰∏ã‰∏ÄÈ°å ‚Üí";
}
function nextQuestion(){
    if(current<19) {current++; renderQuestions(); updateIQBar();}
    else showResult();
}
function previousQuestion(){
    if(current>0){current--; renderQuestions(); updateIQBar();}
}
function showResult(){
    document.getElementById("testScreen").style.display="none";
    document.getElementById("resultScreen").classList.add("active");
    let correct=0;
    answers.forEach((a,i)=>{if(a==selectedQuestions[i].correct) correct++;});
    // ÂàÜÊï∏ËàáÁ≠âÁ¥ö
    const rate = Math.round((correct/20)*100);
    const iqScore = Math.round(90 + (rate/100)*40);
    let level, emoji, desc;
    if(iqScore>=130){
        level='üåü Â§©ÊâçÁ¥öÂà•';emoji='üèÜ';desc='È©ö‰∫∫ÁöÑÊô∫ÂïÜÔºÅ‰Ω†ÁöÑÈÇèËºØÊÄùÁ∂≠ÂíåÂàÜÊûêËÉΩÂäõÂ†™Á®±‰∏ÄÊµÅ„ÄÇ';
    }else if(iqScore>=120){
        level='‚≠ê ÈùûÂ∏∏ÂÑ™ÁßÄ';emoji='üòé';desc='ÈùûÂ∏∏Ê£íÁöÑË°®ÁèæÔºÅ‰Ω†ÁöÑÊô∫ÂïÜÈÅ†È´òÊñºÂπ≥ÂùáÊ∞¥Âπ≥„ÄÇ';
    }else if(iqScore>=110){
        level='üëç ÂÑ™ÁßÄ';emoji='üòä';desc='Âæà‰∏çÈåØÔºÅ‰Ω†ÁöÑË°®ÁèæË∂ÖË∂äÂπ≥ÂùáÔºåÈÇèËºØÊÄùÁ∂≠ËâØÂ•Ω„ÄÇ';
    }else if(iqScore>=100){
        level='‚úÖ Ê®ôÊ∫ñÊô∫ÂïÜ';emoji='ü§î';desc='Ë°®Áèæ‰∏çÈåØÔºÅ‰Ω†ÁöÑÊô∫ÂïÜËôïÊñºÂπ≥ÂùáÊ∞¥Âπ≥„ÄÇ';
    }else if(iqScore>=90){
        level='üìö ÈúÄË¶ÅÂä™Âäõ';emoji='üí™';desc='ÈÇÑÊúâÈÄ≤Ê≠•ÁöÑÁ©∫ÈñìÔºåÂ§öÁ∑¥ÁøíÊúÉÊõ¥Â•ΩÔºÅ';
    }else{
        level='üéØ Âä†Ê≤πÔºÅ';emoji='üåà';desc='ÊØèÊ¨°Á∑¥ÁøíÈÉΩÊòØÂ≠∏ÁøíÁöÑÊ©üÊúÉÔºåÁπºÁ∫åÂä™ÂäõÔºÅ';
    }
    document.getElementById("resultLevel").innerText=level;
    document.getElementById("resultEmoji").innerText=emoji;
    document.getElementById("resultScore").innerText=iqScore;
    document.getElementById("resultDescription").innerText=desc;
    document.getElementById("correctCount").innerText=`${correct}/20`;
    document.getElementById("correctRate").innerText=`${rate}%`;
    updateIQBar(20);
    // ÊàêÈï∑Ê¢ùÊãâÊªø
}
function restartTest(){
    document.getElementById("resultScreen").classList.remove("active");
    document.getElementById("startScreen").style.display="";
    document.getElementById("iqBar").style.width="0%";
}
function shuffle(arr){
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}
// IQÊàêÈï∑Ê¢ùÂãïÁï´
function updateIQBar(forced){
    let currentAns = answers.filter(a=>a!==-1).length;
    document.getElementById("iqBar").style.width = ((currentAns/20)*100)+"%";
}
function animateIQBar(correct){
    const bar = document.getElementById("iqBar");
    bar.style.boxShadow = correct
        ? "0 0 8px 3px #10ac84a3"
        : "0 0 7px 3px #fbc53195";
    setTimeout(()=>{bar.style.boxShadow="";},500);
}
// Á≠îÈ°åÂæåÊµÆÁèæË°®ÊÉÖ
function showEmoji(emoji){
    const dom = document.getElementById("emojiFeedback");
    dom.innerText = emoji;
    dom.style.display = "block";
    dom.style.opacity = 1;
    setTimeout(()=>{dom.style.display="none";dom.innerText="";},870);
}
// Êää‰∏ªË¶ÅÂäüËÉΩÊ≥®ÂÖ• window ËÆì HTML ‰∫ã‰ª∂Ê≠£Â∏∏ÂëºÂè´
window.startTest = startTest;
window.renderQuestions = renderQuestions;
window.selectAnswer = selectAnswer;
window.updateNavUI = updateNavUI;
window.nextQuestion = nextQuestion;
window.previousQuestion = previousQuestion;
window.showResult = showResult;
window.restartTest = restartTest;
</script>
</body>
</html>
